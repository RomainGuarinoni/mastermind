(()=>{"use strict";(()=>{function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function n(e,t){return e.filter((function(e){return e===t})).length}function r(e,t){if(t<e)throw new Error("runStart should be before runEnd");return t.getTime()-e.getTime()}function o(e){return{milliseconds:Math.floor(e%1e3),seconds:Math.floor(e/1e3%60),minutes:Math.floor(e/6e4%60),hours:Math.floor(e/36e5%24)}}function i(e){var t="";return e.hours&&(t+="".concat(e.hours,"h ")),e.minutes&&(t+="".concat(e.minutes,"m ")),e.seconds&&(t+="".concat(e.seconds,"s ")),e.milliseconds&&(t+="".concat(e.milliseconds,"ms ")),""==t&&(t+="0ms "),t}var a;!function(e){e[e.running=0]="running",e[e.win=1]="win",e[e.lose=2]="lose"}(a||(a={}));const c=a;var l;function u(e,t,n){var r=document.createElement("div");r.classList.add("line"),r.id="line-".concat(e);var o=document.createElement("div");o.classList.add("red-indicator-container");var i=document.createElement("div");i.classList.add("white-indicator-container");var a=document.createElement("div");a.classList.add("targets-container");for(var c=0;c<n;c++){var l=document.createElement("div");l.classList.add("target");var u=document.createElement("div");u.classList.add("target-piece"),l.appendChild(u),a.appendChild(l)}i.style.width="".concat(30*n,"px"),o.style.width="".concat(30*n,"px"),r.appendChild(o),r.appendChild(a),r.appendChild(i),t.appendChild(r)}function s(e,t,n){for(var r=0;r<n;r++){var o=document.createElement("div");switch(e){case l.red:o.classList.add("red-indicator");break;case l.white:o.classList.add("white-indicator")}t.appendChild(o)}}function d(e,t){document.getElementById("".concat(e,"-piece")).style.display=t}function m(e){var t=document.getElementById("line-".concat(e));if(!t)throw new Error("Line does not exist");return{targets:t.querySelectorAll("div.targets-container > div.target"),redIndicatorsContainer:t.querySelector("div.red-indicator-container"),whiteIndicatorsContainer:t.querySelector("div.white-indicator-container")}}function f(e,t,n){var r=e.querySelector("span"),o=n+1-t;if(!r)throw new Error("No span found in the tooltip");r.innerHTML="".concat(o),o<=Math.floor(n/3)?r.style.color="red":o<=2*Math.floor(n/3)?r.style.color="orange":r.style.color="green"}function g(e,t){t===c.running?e.innerHTML="Vérifier":e.innerHTML="Voir le résultat"}function v(e,t,n,r){var a="";if(t){var l=i(o(t.time)),u=i(o(n.time-t.time));a="Votre meilleur score dans cette catégorie est de :<br><strong>".concat(l,"</strong> effectué le <strong>").concat(t.date.toLocaleDateString(),"</strong> à <strong>").concat(t.date.toLocaleTimeString(),"</strong><br>"),r==c.win&&(a+='Vous avez mis <strong style="color:var(--red)">'.concat(u,"</strong> de plus"))}else a="Vous n'avez pas encore de record dans cette catégorie.";e.innerHTML=a}function p(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e){var t,n=e.target.id.split("-")[0];null===(t=e.dataTransfer)||void 0===t||t.setData("text/plain",n),e.dataTransfer.effectAllowed="move"}function E(e){e.preventDefault(),e.dataTransfer.dropEffect="move"}function w(e,t){var n;e.preventDefault();var r=e.dataTransfer.getData("text/plain"),o=e.currentTarget.querySelector("div.target-piece");(n=o.classList).remove.apply(n,p(t)),o.classList.add(r,"current-target-piece")}function b(e){var t,n=e.currentTarget.querySelector("div.target-piece");(t=n.classList).remove.apply(t,p(n.classList.value.split(" "))),n.classList.add("target-piece")}function I(e,t){for(var n=0;n<e.length;n++)e[n].addEventListener("dragover",E,!0),e[n].addEventListener("drop",(function(e){return w(e,t)})),e[n].addEventListener("mousedown",b)}function L(e){for(var t=0;t<e.length;t++)e[t].removeEventListener("dragover",E,!0),e[t].removeEventListener("mousedown",b),e[t].classList.remove("current-target")}function B(e){L(m(document.getElementsByClassName("line").length).targets),e.target.closest(".popup").style.display="none"}function S(e){var t=e.nbPossibilities,n=e.nbColors,r=e.nbTurns,o=e.duplicate;return"".concat(o,"-").concat(r,"-").concat(n,"-").concat(t)}function A(e){var t=S(e),n=localStorage.getItem(t);if(!n)return null;var r=JSON.parse(n);return{time:r.time,date:new Date(r.date),category:e}}!function(e){e[e.white=0]="white",e[e.red=1]="red"}(l||(l={}));var C=document.getElementById("game-container"),T=[document.getElementById("blue-piece"),document.getElementById("red-piece"),document.getElementById("green-piece"),document.getElementById("yellow-piece"),document.getElementById("orange-piece"),document.getElementById("black-piece"),document.getElementById("white-piece"),document.getElementById("maroon-piece")];!function(e){window.addEventListener("DOMContentLoaded",(function(){e.forEach((function(e){return e.addEventListener("dragstart",h)}))}))}(T);var M,N=T.map((function(e){return e.id.split("-")[0]})),k=document.getElementById("parametersPopup"),D=document.getElementById("win"),q=document.getElementById("lose");M=function(){te=Y.checked,re=Z.valueAsNumber,ne=_.valueAsNumber,oe=ee.valueAsNumber,!1===te&&re<oe?alert("Attention, autorisez les doublons ou mettez un nombre de couleurs supérieur ou égal au nombre de possibilités par ligne"):(k.style.display="none",ie())},k.addEventListener("submit",(function(e){e.preventDefault(),M()}));var P=document.getElementById("cancelParameters"),V=document.getElementById("verify"),x=document.getElementById("restart"),H=document.getElementById("win-restart"),O=document.getElementById("lose-restart"),j=document.getElementById("parameters");!function(e){for(var t=0;t<e.length;t++)e[t].addEventListener("click",B)}(document.getElementsByClassName("reduce-popUp"));var z,U,R,J,$,F,G,K,Q,W,X=document.getElementById("tooltip"),Y=document.getElementById("duplicateCheck"),Z=document.getElementById("nbColorsValue"),_=document.getElementById("nbTurnsValue"),ee=document.getElementById("nbPossibilitiesValue"),te=Y.checked,ne=_.valueAsNumber,re=Z.valueAsNumber,oe=ee.valueAsNumber;function ie(){F=c.running,f(X,z=1,ne);var t,n=function(e,t){return e.sort((function(){return.5-Math.random()})).slice(0,t)}(N,re);t=n,N.forEach((function(e){t.includes(e)?d(e,"block"):d(e,"none")})),$=function(t,n,r){if(!r&&n>t.length)throw new Error("Impossible to create a combination");if(!1===r){var o=t.sort((function(){return.5-Math.random()}));return Array.from(new Set(o)).slice(0,n)}return e(Array(n)).map((function(){return t[Math.floor(Math.random()*t.length)]}))}(n,oe,te),console.log($),C.innerHTML="",u(z,C,oe);var r=m(z),o=r.targets,i=r.redIndicatorsContainer,a=r.whiteIndicatorsContainer;R=i,J=a,I(U=o,N),g(V,F),G=new Date}function ae(){document.getElementById("nb-round").innerHTML="Tu as trouvé la combinaison en ".concat(z," tours"),D.style.display="flex"}function ce(){var e=document.getElementById("solution-combination");e.innerHTML="";for(var t=0;t<$.length;t++){var n=document.createElement("div");n.classList.add("piece",$[t]),e.appendChild(n)}q.style.display="flex"}function le(){K=new Date,g(V,F),f(X,z+1,ne);var e,t,n,a,l,u,s={category:{nbTurns:ne,nbColors:re,nbPossibilities:oe,duplicate:te},time:r(G,K),date:new Date};if(F===c.win){var d=document.querySelector("#win-record p"),m=(u={isNew:!0,record:e=s,previousRecord:null},function(e){var t=A(e.category);return!t||e.time<t.time}(e)?(u.previousRecord=A(e.category),n=(t=e).category,a=t.time,l=t.date,localStorage.setItem(S(n),JSON.stringify({time:a,date:l}))):(u.isNew=!1,u.record=A(e.category)),u),p=m.isNew,y=m.record,h=m.previousRecord;return p?function(e,t,n){var r="Bravo, vous venez de créer un nouveau record pour cette catégorie !<br>";if(n){var a=i(o(n.time-t.time));r+='Vous avez mis <strong style="color:var(--green)">'.concat(a,"</strong> de moins que votre précédent record")}e.innerHTML=r}(d,y,h):v(d,y,s,F),void ae()}v(document.querySelector("#lose-record p"),A(s.category),s,F),ce()}V.onclick=function(t){t.preventDefault(),F!==c.running?F!==c.win?ce():ae():function(){var t;try{t=function(e,t){for(var n=[],r=function(r){var o=e[r].querySelector("div.target-piece");o.classList.remove("alert");var i=o.className.split(" ").filter((function(e){return t.includes(e)}))[0];i?n.push(i):setTimeout((function(){o.classList.add("alert")}),1)},o=0;o<e.length;o++)r(o);if(n.length!==e.length)throw new Error("Combination is not complete");return n}(U,N)}catch(e){return}var r=function(t,r){var o=[],i=[];return t.forEach((function(t,a){if(r[a]===t)return o.push(t),void(o.filter((function(e){return e===t})).length===n(r,t)&&(i=i.filter((function(e){return e!==t}))));r.includes(t)&&[].concat(o,e(i)).filter((function(e){return e===t})).length<n(r,t)&&i.push(t)})),{goodPlacement:o.length,wrongPlacement:i.length}}(t,$),o=r.goodPlacement,i=r.wrongPlacement;F===c.running&&(s(l.red,R,o),s(l.white,J,i)),o===oe?(F=c.win,le()):z===ne?(F=c.lose,le()):function(){L(U),z++,f(X,z,ne),u(z,C,oe);var e=m(z),t=e.targets,n=e.redIndicatorsContainer,r=e.whiteIndicatorsContainer;R=n,J=r,I(U=t,N)}()}()},x.onclick=ie,P.onclick=function(){k.style.display="none"},j.onclick=function(){k.style.display="flex"},Q=[k.querySelector("#paramsPopUp"),j],W=function(){k.style.display="none"},window.addEventListener("click",(function(e){for(var t=0;t<Q.length;t++)if(Q[t].contains(e.target))return;W()})),H.onclick=function(e){e.preventDefault(),D.style.display="none",ie()},O.onclick=function(e){e.preventDefault(),q.style.display="none",ie()},ie()})()})();
//# sourceMappingURL=bundle.js.map
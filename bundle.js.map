{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://mastermind/./src/combination.ts","webpack://mastermind/./src/listeners.ts","webpack://mastermind/./src/dom-manipulation.ts","webpack://mastermind/./src/index.ts"],"sourcesContent":["/**\n * @param colors the available colors of the game\n * @param nbPossibilities the number of possibilities by line choose by the player\n * @param duplicate boolean that indicate if there are duplicate colors in the combination\n * @returns a combination of X colors, where X is the number of possibilities by line\n */\nexport function generateCombination(\n  colors: string[],\n  nbPossibilities: number,\n  duplicate: boolean,\n) {\n  if (!duplicate && nbPossibilities > colors.length) {\n    throw new Error('Impossible to create a combination');\n  }\n\n  if (duplicate === false) {\n    const shuffleColors = colors.sort(() => 0.5 - Math.random());\n\n    return Array.from(new Set(shuffleColors)).slice(0, nbPossibilities);\n  }\n\n  return [...Array(nbPossibilities)].map(\n    () => colors[Math.floor(Math.random() * colors.length)],\n  );\n}\n\n/**\n *\n * @param currentTargets the targets which contains the current combination\n * @param colors the available colors of the game\n * @returns an array containing the actual combination of colors or an error if the combination is not complete\n */\nexport function getCurrentCombination(\n  currentTargets: NodeListOf<HTMLDivElement>,\n  colors: string[],\n) {\n  const combination: string[] = [];\n\n  for (let i = 0; i < currentTargets.length; i++) {\n    const currentTargetPiece = currentTargets[i].querySelector(\n      'div.target-piece',\n    ) as HTMLDivElement;\n\n    const color = currentTargetPiece.className\n      .split(' ')\n      .filter((e) => colors.includes(e))[0];\n    if (!color) {\n      throw new Error('Combination is not complete');\n    }\n\n    combination.push(color);\n  }\n\n  return combination;\n}\n\n/**\n *\n * @param currentCombination the current combination of colors\n * @param finalCombination the combination of colors to refer to\n * @returns an object containing the number of goodEmplament and wrongEmplacement of the current combination\n */\nexport function getCombinationPlacement(\n  currentCombination: string[],\n  finalCombination: string[],\n) {\n  const goodPlacement: string[] = [];\n  let wrongPlacement: string[] = [];\n\n  currentCombination.forEach((color, index) => {\n    if (finalCombination[index] === color) {\n      goodPlacement.push(color);\n\n      /**\n       * remove the color from the wrong emplacement if we already\n       * have all the good placement. This verification allow to delete\n       * the duplicates indicators.\n       * see https://github.com/RomainGuarinoni/mastermind/issues/8\n       */\n      if (\n        goodPlacement.filter((e) => e === color).length ===\n        getColorApparition(finalCombination, color)\n      ) {\n        wrongPlacement = wrongPlacement.filter((e) => e !== color);\n      }\n\n      return;\n    }\n\n    if (\n      finalCombination.includes(color) &&\n      [...goodPlacement, ...wrongPlacement].filter((e) => e === color).length <\n        getColorApparition(finalCombination, color)\n    ) {\n      wrongPlacement.push(color);\n      return;\n    }\n  });\n\n  return {\n    goodPlacement: goodPlacement.length,\n    wrongPlacement: wrongPlacement.length,\n  };\n}\n\n/**\n *\n * @param combination a combination of colors\n * @param color the available colors of the game\n * @returns the number of time a color appear in a combination\n */\nexport function getColorApparition(combination: string[], color: string) {\n  return combination.filter((e) => e === color).length;\n}\n\n/**\n * @description Return an array with only the number of colors wanted\n * @param colors the initial array of colors\n * @param nbColors number of colors wanted by the player\n */\nexport function getAvailableColors(colors: string[], nbColors: number) {\n  const shuffleArray = colors.sort(() => 0.5 - Math.random());\n  return shuffleArray.slice(0, nbColors);\n}\n","/**\n * @description Set the piece data transfer to its color\n * @param e the drag event of the listener\n */\nfunction setPieceDragData(e: DragEvent) {\n  const color = (e.target as Element).id.split('-')[0];\n  e.dataTransfer?.setData('text/plain', color);\n  (e.dataTransfer as DataTransfer).effectAllowed = 'move';\n}\n\n/**\n * @description listener function on drag over event\n * @param e the event of the listener\n */\nfunction setTargetDropEffect(e: Event) {\n  e.preventDefault();\n  ((e as DragEvent).dataTransfer as DataTransfer).dropEffect = 'move';\n}\n\n/**\n * @description get the color of the drag item and change the target piece\n *  background to this color\n * @param e the drag event of the listener\n * @param colors the colors available in the game\n */\nfunction setTargetBackgroundColor(e: DragEvent, colors: string[]) {\n  e.preventDefault();\n  const color = (e.dataTransfer as DataTransfer).getData('text/plain');\n  const targetPiece = (e.currentTarget as Element).querySelector(\n    'div.target-piece',\n  ) as HTMLDivElement;\n\n  targetPiece.classList.remove(...colors);\n  targetPiece.classList.add(color, 'current-target-piece');\n}\n\n/**\n * @description remove the color of a target piece if the target is clicked\n * @param e\n */\nfunction removeColorFromTarget(e: Event) {\n  const targetPiece = (e.currentTarget as Element).querySelector(\n    'div.target-piece',\n  ) as HTMLDivElement;\n\n  targetPiece.classList.remove(...targetPiece.classList.value.split(' '));\n  targetPiece.classList.add('target-piece');\n}\n\n/**\n * @description Add the drag event listeners of the targets\n * @param targets the targets to add eventListeners\n * @param colors the colors available in the game\n */\nexport function addTargetListener(\n  targets: NodeListOf<Element>,\n  colors: string[],\n) {\n  for (let i = 0; i < targets.length; i++) {\n    targets[i].addEventListener('dragover', setTargetDropEffect, true);\n\n    targets[i].addEventListener('drop', (e) =>\n      setTargetBackgroundColor(e as DragEvent, colors),\n    ),\n      true;\n\n    targets[i].addEventListener('mousedown', removeColorFromTarget);\n  }\n}\n\n/**\n * @description Remove the drag event listener of the targets\n * @param target The targets to remove eventListeners\n */\nexport function removeTargetListener(targets: NodeListOf<Element>) {\n  for (let i = 0; i < targets.length; i++) {\n    targets[i].removeEventListener('dragover', setTargetDropEffect, true);\n    targets[i].removeEventListener('mousedown', removeColorFromTarget);\n    targets[i].classList.remove('current-target');\n  }\n}\n\n/**\n * @description Add dragStart events on game pieces\n * @param pieces All the pieces of the game\n */\nexport function setDragListenerOnPieces(pieces: Array<HTMLDivElement>) {\n  window.addEventListener('DOMContentLoaded', () => {\n    pieces.forEach((piece) =>\n      piece.addEventListener('dragstart', setPieceDragData),\n    );\n  });\n}\n","export enum Indicators {\n  'white',\n  'red',\n}\n\ntype Display = 'block' | 'flex' | 'none' | 'inline';\n\n/**\n * @description Add a new line to the game container\n * @param index the index for the line id\n * @param gameContainer the game container element wich contains the lines\n * @param nbPossibilities the number of possibilities by line\n */\nexport function addNewGameLine(\n  round: number,\n  gameContainer: Element,\n  nbPossibilities: number,\n) {\n  const line = document.createElement('div');\n  line.classList.add('line');\n  line.id = `line-${round}`;\n\n  const redIndicatorContainer = document.createElement('div');\n  redIndicatorContainer.classList.add('red-indicator-container');\n\n  const whiteIndicatorContainer = document.createElement('div');\n  whiteIndicatorContainer.classList.add('white-indicator-container');\n\n  const targetContainer = document.createElement('div');\n  targetContainer.classList.add('targets-container');\n\n  for (let i = 0; i < nbPossibilities; i++) {\n    const target = document.createElement('div');\n    target.classList.add('target');\n\n    const targetPiece = document.createElement('div');\n    targetPiece.classList.add('target-piece');\n\n    target.appendChild(targetPiece);\n    targetContainer.appendChild(target);\n  }\n\n  whiteIndicatorContainer.style.width = `${nbPossibilities * 30}px`;\n  redIndicatorContainer.style.width = `${nbPossibilities * 30}px`;\n\n  line.appendChild(redIndicatorContainer);\n  line.appendChild(targetContainer);\n  line.appendChild(whiteIndicatorContainer);\n\n  gameContainer.appendChild(line);\n}\n\n/**\n * @description Add indicators to the game\n * @param type the type of indicators\n * @param container the container where to put indicators\n * @param number the number of indicators to add\n */\nexport function addIndicators(\n  type: Indicators,\n  container: Element,\n  number: number,\n) {\n  for (let i = 0; i < number; i++) {\n    const indicator = document.createElement('div');\n\n    switch (type) {\n      case Indicators.red:\n        indicator.classList.add('red-indicator');\n        break;\n      case Indicators.white:\n        indicator.classList.add('white-indicator');\n        break;\n    }\n\n    container.appendChild(indicator);\n  }\n}\n\n/**\n * @description change the display of a specify piece\n * @param color the color of the piece\n * @param display the style of display to apply\n */\nexport function changePieceDisplay(color: string, display: Display) {\n  const piece = document.getElementById(`${color}-piece`) as HTMLDivElement;\n  piece.style.display = display;\n}\n\n/**\n *\n * @param colors an array of all the colors\n * @param finalColors an array of wanted colors\n */\nexport function hideUnwantedColor(colors: string[], finalColors: string[]) {\n  colors.forEach((color) => {\n    if (finalColors.includes(color)) {\n      changePieceDisplay(color, 'block');\n    } else {\n      changePieceDisplay(color, 'none');\n    }\n  });\n}\n\n/**\n *\n * @param round the current round index needed to find DOM elements\n * @returns An object containing the DOM elements of the game\n */\nexport function getGameDomElements(round: number) {\n  const line = document.getElementById(`line-${round}`);\n\n  if (!line) {\n    throw new Error('Line does not exist');\n  }\n\n  const targets = line.querySelectorAll(\n    `div.targets-container > div.target`,\n  ) as NodeListOf<HTMLDivElement>;\n  const redIndicatorsContainer = line.querySelector(\n    'div.red-indicator-container',\n  ) as HTMLDivElement;\n  const whiteIndicatorsContainer = line.querySelector(\n    'div.white-indicator-container',\n  ) as HTMLDivElement;\n\n  return {\n    targets,\n    redIndicatorsContainer,\n    whiteIndicatorsContainer,\n  };\n}\n\n/**\n * @description Update the value and the color of the tooltip when we hover the verify button\n * @param tooltip the DOM tooltip wich contains a <p> with a <span> inside\n * @param roundLeft the number of rounds left in the game\n */\nexport function updateTooltip(\n  tooltip: HTMLDivElement,\n  currentRound: number,\n  nbTurns: number,\n) {\n  const span = tooltip.querySelector('span');\n\n  const roundLeft = nbTurns + 1 - currentRound;\n\n  if (!span) {\n    throw new Error('No span found in the tooltip');\n  }\n\n  span.innerHTML = `${roundLeft}`;\n\n  if (roundLeft <= Math.floor(nbTurns / 3)) {\n    span.style.color = 'red';\n    return;\n  }\n\n  if (roundLeft <= Math.floor(nbTurns / 3) * 2) {\n    span.style.color = 'orange';\n    return;\n  }\n\n  span.style.color = 'green';\n}\n","import {\n  getCurrentCombination,\n  getCombinationPlacement,\n  generateCombination,\n  getAvailableColors,\n} from './combination';\n\nimport {\n  addTargetListener,\n  removeTargetListener,\n  setDragListenerOnPieces,\n} from './listeners';\n\nimport {\n  addNewGameLine,\n  addIndicators,\n  Indicators,\n  hideUnwantedColor,\n  getGameDomElements,\n  updateTooltip,\n} from './dom-manipulation';\n\n// get the game container\nconst gameContainer = document.getElementById(\n  'game-container',\n) as HTMLDivElement;\n\n// Get all the pieces of the game\nconst bluePiece = document.getElementById('blue-piece') as HTMLDivElement;\nconst redPiece = document.getElementById('red-piece') as HTMLDivElement;\nconst greenPiece = document.getElementById('green-piece') as HTMLDivElement;\nconst yellowPiece = document.getElementById('yellow-piece') as HTMLDivElement;\nconst orangePiece = document.getElementById('orange-piece') as HTMLDivElement;\nconst blackPiece = document.getElementById('black-piece') as HTMLDivElement;\nconst whitePiece = document.getElementById('white-piece') as HTMLDivElement;\nconst marronPiece = document.getElementById('maroon-piece') as HTMLDivElement;\nconst pieces = [\n  bluePiece,\n  redPiece,\n  greenPiece,\n  yellowPiece,\n  orangePiece,\n  blackPiece,\n  whitePiece,\n  marronPiece,\n];\n\nsetDragListenerOnPieces(pieces);\n\n// All the color available in the game based on the pieces id available\nconst COLORS = pieces.map((piece) => piece.id.split('-')[0]);\n\n// Get all Popup\nconst parametersPopup = document.getElementById(\n  'parametersPopup',\n) as HTMLDivElement;\nconst winPopup = document.getElementById('win') as HTMLDivElement;\nconst loosePopup = document.getElementById('loose') as HTMLDivElement;\n\n// The button of the game\nconst applyParametersButton = document.getElementById(\n  'applyParameters',\n) as HTMLButtonElement;\nconst cancelParametersButton = document.getElementById(\n  'cancelParameters',\n) as HTMLButtonElement;\nconst verifyButton = document.getElementById('verify') as HTMLButtonElement;\nconst restartButton = document.getElementById('restart') as HTMLButtonElement;\nconst winRestartButton = document.getElementById(\n  'win-restart',\n) as HTMLButtonElement;\nconst looseRestartButton = document.getElementById(\n  'loose-restart',\n) as HTMLButtonElement;\nconst parametersButton = document.getElementById(\n  'parameters',\n) as HTMLButtonElement;\n\n// The tooltip of the verify button\n\nconst verifyTooltip = document.getElementById('tooltip') as HTMLDivElement;\n\n// Parameters value from the DOM Popup\nconst duplicateCheckBox = document.getElementById(\n  'duplicateCheck',\n) as HTMLInputElement;\nconst nbColorsValue = document.getElementById(\n  'nbColorsValue',\n) as HTMLInputElement;\nconst nbTurnsValue = document.getElementById(\n  'nbTurnsValue',\n) as HTMLInputElement;\nconst nbPossibilitiesValue = document.getElementById(\n  'nbPossibilitiesValue',\n) as HTMLInputElement;\n\n// Current game round\n// min : 1 | max : nbTurns\nlet currentRound: number;\n\n// Game DOM variables\nlet currentTargets: NodeListOf<HTMLDivElement>;\nlet currentRedIndicatorsContainer: HTMLDivElement;\nlet currentWhiteIndicatorsContainer: HTMLDivElement;\n\nlet gameCombination: string[];\n\n// Game params\n\n/**\n * A boolean that indicates whether the combination can have\n * duplicate colors or not\n **/\nlet duplicate = duplicateCheckBox.checked;\n\n/**\n * The number of turns in the game\n */\nlet nbTurns = nbTurnsValue.valueAsNumber;\n\n/**\n * The number of colors available for the player\n */\nlet nbColors = nbColorsValue.valueAsNumber;\n\n/**\n * The number of colors in a line\n */\nlet nbPossibilities = nbPossibilitiesValue.valueAsNumber;\n\n/**\n * @description Reset all the HTML of the game container and start a new game\n * by generating a new combination and reset game DOM variables\n */\nfunction startNewGame() {\n  currentRound = 1;\n  updateTooltip(verifyTooltip, currentRound, nbTurns);\n  const colorsAvailable = getAvailableColors(COLORS, nbColors);\n\n  hideUnwantedColor(COLORS, colorsAvailable);\n\n  gameCombination = generateCombination(\n    colorsAvailable,\n    nbPossibilities,\n    duplicate,\n  );\n\n  gameContainer.innerHTML = '';\n  addNewGameLine(currentRound, gameContainer, nbPossibilities);\n\n  const { targets, redIndicatorsContainer, whiteIndicatorsContainer } =\n    getGameDomElements(currentRound);\n\n  currentTargets = targets;\n  currentRedIndicatorsContainer = redIndicatorsContainer;\n  currentWhiteIndicatorsContainer = whiteIndicatorsContainer;\n  addTargetListener(currentTargets, COLORS);\n}\n\n/**\n * @description Remove all the events of the previous line, create a new line with the current index,\n * update the game DOM variables and add eventListeners to them\n */\nfunction createNewRound() {\n  removeTargetListener(currentTargets);\n\n  currentRound++;\n\n  updateTooltip(verifyTooltip, currentRound, nbTurns);\n\n  addNewGameLine(currentRound, gameContainer, nbPossibilities);\n  const { targets, redIndicatorsContainer, whiteIndicatorsContainer } =\n    getGameDomElements(currentRound);\n\n  currentTargets = targets;\n  currentRedIndicatorsContainer = redIndicatorsContainer;\n  currentWhiteIndicatorsContainer = whiteIndicatorsContainer;\n  addTargetListener(currentTargets, COLORS);\n}\n\n/**\n * @description Add the nbRound value to the win popup and display it\n */\nfunction displayWinPopup() {\n  (\n    document.getElementById('nb-round') as HTMLParagraphElement\n  ).innerHTML = `Tu as trouvé la combinaison en ${currentRound} tours`;\n  winPopup.style.display = 'flex';\n}\n\n/**\n * @description Add the game combination to the loose popup and display it\n */\nfunction displayLoosePopup() {\n  const solutionCombinaison = document.getElementById(\n    'solution-combination',\n  ) as HTMLDivElement;\n\n  // Reset previous solution\n  solutionCombinaison.innerHTML = '';\n\n  for (let i = 0; i < gameCombination.length; i++) {\n    const div = document.createElement('div');\n    div.classList.add('piece', gameCombination[i]);\n    solutionCombinaison.appendChild(div);\n  }\n  loosePopup.style.display = 'flex';\n}\n\n/**\n * @description Verify the current combination. It can either:\n *  - display an error if the currentCombination is not complete\n *  - add indicators to the current line and add a new line\n *  - display win popup if the player find the gameCombination\n *  - display loose popup if the player failed to find the gameCombination\n */\nfunction verifyCurrentCombination() {\n  let currentCombination: string[];\n\n  try {\n    currentCombination = getCurrentCombination(currentTargets, COLORS);\n  } catch (err) {\n    alert('Mettez des pions dans chaque emplacement de la ligne');\n    return;\n  }\n\n  const { goodPlacement, wrongPlacement } = getCombinationPlacement(\n    currentCombination,\n    gameCombination,\n  );\n\n  addIndicators(Indicators.red, currentRedIndicatorsContainer, goodPlacement);\n\n  addIndicators(\n    Indicators.white,\n    currentWhiteIndicatorsContainer,\n    wrongPlacement,\n  );\n\n  if (goodPlacement === nbPossibilities) {\n    displayWinPopup();\n    return;\n  }\n\n  if (currentRound === nbTurns) {\n    displayLoosePopup();\n    return;\n  }\n\n  createNewRound();\n}\n\n/**\n * @description Set the params value and check if a new game can start with these params. If not,\n * it display an error\n */\nfunction applyParameters() {\n  duplicate = duplicateCheckBox.checked;\n  nbColors = nbColorsValue.valueAsNumber;\n  nbTurns = nbTurnsValue.valueAsNumber;\n  nbPossibilities = nbPossibilitiesValue.valueAsNumber;\n  if (duplicate === false && nbColors < nbPossibilities) {\n    alert(\n      `Attention, autorisez les doublons ou mettez un nombre de couleurs supérieur ou égal au nombre de possibilités par ligne`,\n    );\n    return;\n  }\n  parametersPopup.style.display = 'none';\n  startNewGame();\n}\n\nverifyButton.onclick = verifyCurrentCombination;\n\nrestartButton.onclick = startNewGame;\n\n// add apply parameters event\napplyParametersButton.onclick = applyParameters;\n\n// add cancel parameters event\ncancelParametersButton.onclick = () => {\n  parametersPopup.style.display = 'none';\n};\n\nparametersButton.onclick = () => {\n  parametersPopup.style.display = 'flex';\n};\n\nwinRestartButton.onclick = (e) => {\n  e.preventDefault();\n  winPopup.style.display = 'none';\n  startNewGame();\n};\n\nlooseRestartButton.onclick = (e) => {\n  e.preventDefault();\n  loosePopup.style.display = 'none';\n  startNewGame();\n};\n\nstartNewGame();\n"],"names":["getColorApparition","combination","color","filter","e","length","setPieceDragData","target","id","split","dataTransfer","setData","effectAllowed","setTargetDropEffect","preventDefault","dropEffect","setTargetBackgroundColor","colors","getData","targetPiece","currentTarget","querySelector","classList","remove","add","removeColorFromTarget","value","addTargetListener","targets","i","addEventListener","Indicators","addNewGameLine","round","gameContainer","nbPossibilities","line","document","createElement","redIndicatorContainer","whiteIndicatorContainer","targetContainer","appendChild","style","width","addIndicators","type","container","number","indicator","red","white","changePieceDisplay","display","getElementById","getGameDomElements","Error","querySelectorAll","redIndicatorsContainer","whiteIndicatorsContainer","updateTooltip","tooltip","currentRound","nbTurns","span","roundLeft","innerHTML","Math","floor","pieces","window","forEach","piece","setDragListenerOnPieces","currentTargets","currentRedIndicatorsContainer","currentWhiteIndicatorsContainer","gameCombination","COLORS","map","parametersPopup","winPopup","loosePopup","applyParametersButton","cancelParametersButton","verifyButton","restartButton","winRestartButton","looseRestartButton","parametersButton","verifyTooltip","duplicateCheckBox","nbColorsValue","nbTurnsValue","nbPossibilitiesValue","duplicate","checked","valueAsNumber","nbColors","startNewGame","finalColors","colorsAvailable","sort","random","slice","getAvailableColors","includes","shuffleColors","Array","from","Set","generateCombination","onclick","currentCombination","className","push","getCurrentCombination","err","alert","finalCombination","goodPlacement","wrongPlacement","index","getCombinationPlacement","removeEventListener","removeTargetListener","createNewRound","solutionCombinaison","div","displayLoosePopup"],"sourceRoot":""}